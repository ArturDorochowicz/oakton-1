import{_ as s,c as n,o as a,a as t}from"./app.012e36bd.js";const h='{"title":"Writing Extension Commands","description":"","frontmatter":{},"relativePath":"guide/host/extensions.md","lastUpdated":1655919011680}',o={},e=t(`<h1 id="writing-extension-commands" tabindex="-1">Writing Extension Commands <a class="header-anchor" href="#writing-extension-commands" aria-hidden="true">#</a></h1><p>Oakton has a strong extensibility model to find and activate commands from external assemblies. If an application uses the <code>RunOaktonCommands(args)</code> method, Oakton will look for any Oakton commands in any assembly that has this assembly level attribute:</p><p><a id="snippet-sample_using_oaktoncommandassemblyattribute"></a></p><div class="language-cs"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">assembly</span><span class="token punctuation">:</span><span class="token class-name">Oakton<span class="token punctuation">.</span>OaktonCommandAssembly</span></span><span class="token punctuation">]</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/AspNetCoreExtensionCommands/BuildCommand.cs#L4-L6" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_using_oaktoncommandassemblyattribute" title="Start of snippet">anchor</a></sup></p><div class="tip custom-block"><p class="custom-block-title">warning</p><p>You will have to explicitly add this attribute to the main assembly of your application to make Oakton discover commands in that assembly. Oakton no longer supports trying to walk the call stack to determine the main application assembly.</p></div><p>Extension commands can be either basic <code>OaktonCommand</code> or <code>OaktonAsyncCommand</code> classes. To add an extension command that uses the <code>HostBuilder</code> configuration of the application, the command needs to use the <code>NetCoreInput</code> class or a class that inherits from <code>NetCoreInput</code>. In this simple example below, I&#39;ve built a command that just tries to do a &quot;smoke test&quot; by calling the <code>HostBuilder.Build()</code> method and seeing if any exceptions happen:</p><p><a id="snippet-sample_smokecommand"></a></p><div class="language-cs"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;Simply try to build a web host as a smoke test&quot;</span><span class="token punctuation">,</span> Name <span class="token operator">=</span> <span class="token string">&quot;smoke&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SmokeCommand</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">OaktonCommand<span class="token punctuation">&lt;</span>NetCoreInput<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token class-name">NetCoreInput</span> input<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// This method builds out the IWebHost for your</span>
        <span class="token comment">// configured IHostBuilder of the application</span>
        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> host <span class="token operator">=</span> input<span class="token punctuation">.</span><span class="token function">BuildHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;It&#39;s all good&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/AspNetCoreExtensionCommands/BuildCommand.cs#L11-L27" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_smokecommand" title="Start of snippet">anchor</a></sup></p><p>The <code>NetCoreInput</code> carries the <code>IHostBuilder</code> of your application, but does <strong>not</strong> start up or build the <code>IHost</code> by itself. You would have to explicitly do so, but making that lazy gives you the ability to alter or extend the application configuration before calling <code>IHostBuilder.Build()</code> or <code>IHostBuilder.Start()</code>.</p>`,11),p=[e];function c(i,l,u,r,d,m){return a(),n("div",null,p)}var b=s(o,[["render",c]]);export{h as __pageData,b as default};
