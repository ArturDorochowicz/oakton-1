import{_ as n,c as s,o as a,a as t}from"./app.012e36bd.js";const h='{"title":"Getting Started","description":"","frontmatter":{},"headers":[{"level":2,"title":"Your First Command","slug":"your-first-command"},{"level":2,"title":"How it Works","slug":"how-it-works"},{"level":2,"title":"Multiple Commands in One Tool","slug":"multiple-commands-in-one-tool"}],"relativePath":"guide/getting_started.md","lastUpdated":1655919011647}',e={},o=t(`<h1 id="getting-started" tabindex="-1">Getting Started <a class="header-anchor" href="#getting-started" aria-hidden="true">#</a></h1><div class="tip custom-block"><p class="custom-block-title">warning</p><p>The power of Oakton really comes into play when it&#39;s combined with applications using the <code>HostBuilder</code> mechanism for bootstrapping .Net applications. See <a href="/guide/host/">Integration with IHost</a> for more information.</p></div><p>Oakton originated in the now defunct <a href="https://github.com/DarthFubuMVC/fubucore" target="_blank" rel="noopener noreferrer">FubuCore</a> project in 2010 as a mechanism to allow our .Net development team of that time to build robust console line utilities with these attributes:</p><ul><li>Make it easy to embed and expose command help for user friendliness</li><li>Be consistent with Unix/Linux command line idioms from arguments and optional names -- i.e., make the command line usage feel like Git&#39;s command line syntax</li><li>Easily enable tools to expose multiple commands</li><li>Completely separate the command line parsing from the actual functionality of the console application for easier testing of the command line tools and cleaner code</li><li>Validate user input and helpfully tell them when it&#39;s invalid and what the correct usage should be</li></ul><p>Oakton was originally extracted from FubuCore as a new standalone project before adding some new improvements and support for .Net Core and now .Net 5.0.</p><h2 id="your-first-command" tabindex="-1">Your First Command <a class="header-anchor" href="#your-first-command" aria-hidden="true">#</a></h2><p>To get started, simply create a new dotnet console application and add the <code>Oakton</code> nuget dependency. For your first command, let&#39;s start simple with a command that will simply print out a specified name with an optional color and title. The logical first step is to just create the input class for your command that will establish the arguments and an optional flag:</p><p><a id="snippet-sample_nameinput"></a></p><div class="language-cs"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NameInput</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;The name to be printed to the console output&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Name <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;The color of the text. Default is black&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">ConsoleColor</span> Color <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> ConsoleColor<span class="token punctuation">.</span>Black<span class="token punctuation">;</span>

    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;Optional title preceeding the name&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> TitleFlag <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/quickstart/Program.cs#L19-L31" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_nameinput" title="Start of snippet">anchor</a></sup></p><p>You&#39;ll note that I&#39;ve added some <code>[Oakton.Description]</code> attributes strictly for the purpose of adding user help messages that we&#39;ll take a look at later. Now that we&#39;ve got that out of the way, let&#39;s create our first command:</p><p><a id="snippet-sample_namecommand"></a></p><div class="language-cs"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;Print somebody&#39;s name&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NameCommand</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">OaktonCommand<span class="token punctuation">&lt;</span>NameInput<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token function">NameCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// The usage pattern definition here is completely</span>
        <span class="token comment">// optional</span>
        <span class="token function">Usage</span><span class="token punctuation">(</span><span class="token string">&quot;Default Color&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Arguments</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Usage</span><span class="token punctuation">(</span><span class="token string">&quot;Print name with specified color&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Arguments</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>Color<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token class-name">NameInput</span> input<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> text <span class="token operator">=</span> input<span class="token punctuation">.</span>Name<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">string</span><span class="token punctuation">.</span><span class="token function">IsNullOrEmpty</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>TitleFlag<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            text <span class="token operator">=</span> input<span class="token punctuation">.</span>TitleFlag <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> text<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// This is a little helper in Oakton for getting</span>
        <span class="token comment">// cute with colors in the console output</span>
        ConsoleWriter<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span>Color<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Just telling the OS that the command</span>
        <span class="token comment">// finished up okay</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/quickstart/Program.cs#L33-L63" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_namecommand" title="Start of snippet">anchor</a></sup></p><p>With that in place, let&#39;s wire it up to our applications <code>Program.Main()</code>:</p><p><a id="snippet-sample_quickstart.program1"></a></p><div class="language-cs"><pre><code><span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// As long as this doesn&#39;t blow up, we&#39;re good to go</span>
        <span class="token keyword">return</span> CommandExecutor<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">ExecuteCommand</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>NameCommand<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/quickstart/Program.cs#L8-L17" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_quickstart.program1" title="Start of snippet">anchor</a></sup></p><p>Now, from the command line, I&#39;ll just try <code>dotnet run</code>, which will give us this (slightly elided) output complaining that we&#39;re missing a required argument or two:</p><div class="language-"><pre><code>Invalid usage

name - Print somebody&#39;s name
\u251C\u2500\u2500 Default Color
\u2502   \u2514\u2500\u2500 dotnet run -- name &lt;name&gt;
\u2502       \u2514\u2500\u2500 [-t, --title &lt;title&gt;]
\u2514\u2500\u2500 Print name with specified color
    \u2514\u2500\u2500 dotnet run -- name &lt;name&gt;
        Black|DarkBlue|DarkGreen|DarkCyan|DarkRed|DarkMagenta|DarkYellow|Gray|DarkGray|Blue|Green|Cyan|Red|Magenta|Yello
        w|White
        \u2514\u2500\u2500 [-t, --title &lt;title&gt;]


                  Usage   Description
\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
                   name   The name to be printed to the console output
                  color   The color of the text. Default is black
  [-t, --title &lt;title&gt;]   Optional title preceeding the name
</code></pre></div><p>Do note that we could get the same output without the angry &quot;Invalid Usage&quot; message by:</p><div class="language-"><pre><code>dotnet run -- help
</code></pre></div><p>or</p><div class="language-"><pre><code>dotnet run -- ?
</code></pre></div><p>Now, to actually run the command, try:</p><div class="language-"><pre><code>dotnet run -- &quot;Alex Smith&quot;
</code></pre></div><p>Which will simply print out <em>Alex Smith</em> to the console output. We had to wrap the text in quotations so that Oakton treated the full name with spaces as a single argument.</p><div class="tip custom-block"><p class="custom-block-title">warning</p><p>The &quot;--&quot; argument shown in the samples here is only a construct of using the &quot;dotnet run&quot; command to separate arguments that should apply to the dotnet tool on the left from arguments that should be passed into our application. If you run the compiled application itself, you will not need the &quot;--&quot; separator.</p></div><p>To print the name in blue, we can type <code>dotnet run -- &quot;Alex Smith&quot; Blue</code>. To add a title, we can use the signature <code>dotnet run -- &quot;Alex Smith&quot; --title Mr</code> or <code>dotnet run -- &quot;Alex Smith&quot; --t Mr</code> to get the output &quot;Mr Alex Smith.&quot;</p><h2 id="how-it-works" tabindex="-1">How it Works <a class="header-anchor" href="#how-it-works" aria-hidden="true">#</a></h2><p>Oakton is attempting to take the tokenized values in the command line input and apply the values to the matching fields or properties on the input class objects before passing that object into the proper command&#39;s <code>Execute()</code> method. Oakton also validates that the signature and flag usage matches the known command syntax.</p><h2 id="multiple-commands-in-one-tool" tabindex="-1">Multiple Commands in One Tool <a class="header-anchor" href="#multiple-commands-in-one-tool" aria-hidden="true">#</a></h2><p>Now, let&#39;s move on to building a tool with multiple commands. Let&#39;s say that we&#39;re trying to partially recreate the git command line with the <code>clean</code> and <code>checkout</code> commands:</p><p><a id="snippet-sample_git_commands"></a></p><div class="language-cs"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;Switch branches or restore working tree files&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CheckoutCommand</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">OaktonAsyncCommand<span class="token punctuation">&lt;</span>CheckoutInput<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token class-name">CheckoutInput</span> input<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">await</span> Task<span class="token punctuation">.</span>CompletedTask<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;Remove untracked files from the working tree&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CleanCommand</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">OaktonCommand<span class="token punctuation">&lt;</span>CleanInput<span class="token punctuation">&gt;</span></span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> <span class="token function">Execute</span><span class="token punctuation">(</span><span class="token class-name">CleanInput</span> input<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/MultipleCommands/Program.cs#L42-L61" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_git_commands" title="Start of snippet">anchor</a></sup></p><p>In the <code>Program.Main()</code>, the setup is just a little bit different to go discover all the commands held in the application:</p><p><a id="snippet-sample_multiplecommands.program.main"></a></p><div class="language-cs"><pre><code><span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> args<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name"><span class="token keyword">var</span></span> executor <span class="token operator">=</span> CommandExecutor<span class="token punctuation">.</span><span class="token function">For</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Find and apply all command classes discovered</span>
        <span class="token comment">// in this assembly</span>
        _<span class="token punctuation">.</span><span class="token function">RegisterCommands</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Program</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetTypeInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> executor<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/MultipleCommands/Program.cs#L11-L23" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_multiplecommands.program.main" title="Start of snippet">anchor</a></sup></p><p>Now then, typing <code>dotnet run</code> without specifying a valid command will give you this:</p><div class="language-"><pre><code>  ------------------------------------------------------------------
    Available commands:
  ------------------------------------------------------------------
    checkout -&gt; Switch branches or restore working tree files
       clean -&gt; Remove untracked files from the working tree
  ------------------------------------------------------------------
</code></pre></div><p>Typing <code>dotnet run -- help</code> or <code>dotnet run -- ?</code> would give you the same information.</p><p>Our fake <code>clean</code> command has this usage:</p><p><a id="snippet-sample_cleaninput"></a></p><div class="language-cs"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CleanInput</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;Do it now!&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> ForceFlag <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FlagAlias</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string character">&#39;d&#39;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;Remove untracked directories in addition to untracked files&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> RemoveUntrackedDirectoriesFlag <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">FlagAlias</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string character">&#39;x&#39;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Description</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token string">&quot;Remove only files ignored by Git&quot;</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">bool</span></span> DoNoUseStandardIgnoreRulesFlag <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><sup><a href="https://github.com/JasperFx/alba/blob/master/src/MultipleCommands/Program.cs#L76-L90" title="Snippet source file">snippet source</a> | <a href="#snippet-sample_cleaninput" title="Start of snippet">anchor</a></sup></p><p>To see the specific usage of the <code>clean</code> command, try <code>dotnet run -- help clean</code> or <code>dotnet run -- ? clean</code> to get the usage:</p><div class="language-"><pre><code> Usages for &#39;clean&#39; (Remove untracked files from the working tree)
  clean [-f, --force] [-d, --remove-untracked-directories] [-x, --do-no-use-standard-ignore-rules]

  -------------------------------------------------------------------------------------------
    Flags
  -------------------------------------------------------------------------------------------
                              [-f, --force] -&gt; Do it now!
       [-d, --remove-untracked-directories] -&gt; Remove untracked directories in addition to untracked files
    [-x, --do-no-use-standard-ignore-rules] -&gt; Remove only files ignored by Git
  -------------------------------------------------------------------------------------------
</code></pre></div>`,49),p=[o];function c(l,i,u,r,k,d){return a(),s("div",null,p)}var g=n(e,[["render",c]]);export{h as __pageData,g as default};
